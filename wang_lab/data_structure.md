# Fluorescence traces
Our pipeline uses the `F.mat` file generated by `suite2p`,
which is a copy of the data in the `.npy` files.
Please refer to the
[sutie2p documentation](https://suite2p.readthedocs.io/en/latest/outputs.html)
what the indidual fields in the `F.mat` file mean.

# `*_Behav2PDataLFP.mat`
This file contains the activity from suite2p merged with the behavioral data.
Note that this only includes "good" cells as (manually) classified via suite2p.

## `Clu`
Data for the suite2p ROIs (copied from [sutie2p documentation](https://suite2p.readthedocs.io/en/latest/outputs.html)).
Note that some definitions are different for alternative detection algorithms, such as `lam`, `footprint`.

- `aspect_ratio`: ratio between major and minor axes of a 2D Gaussian fit to mask
- `chan2_prob`: not documented, see `suite2p.detection.stats.roi_stats`
- `compact`: how compact the ROI is (1 is a disk, >1 means less compact)
- `footprint`: spatial extent of an ROIâ€™s functional signal, including pixels not assigned to the ROI;
a threshold of 1/5 of the max is used as a threshold,
and the average distance of these pixels from the center is defined as the footprint
- `lam`: pixel mask (sum(lam * frames[ypix,xpix,:]) = fluorescence) 
- `localClu`: ID of shank, only relevant for ephys, 1-based
- `med`: (y,x) center of cell
- `mrs`: not documented, see `suite2p.detection.stats.roi_stats`
- `npix`: number of pixels per ROI
- `npix_norm`: number of pixels in ROI normalized by the mean of npix across all ROIs
- `radius`: estimated radius of cell from 2D Gaussian fit to mask
- `skew`: skewness of neuropil-corrected fluorescence trace
- `solidity`: not documented, see `suite2p.detection.stats.roi_stats`
- `std`: standard deviation of neuropil-corrected fluorescence trace
- `xpix`: x-pixels of cell
- `ypix`: y-pixels of cell


## `Laps`
- `airpuffLfpInd` - no longer in use
- `airpuffT` - no longer in use
- `behavType`
- `corrChoice` - no longer in use
- `endLfpInd` - end time of each trial in samples - from the $NT directive
- `endT`
- `lapID` - lap id for each trial
- `lickLfpInd` - the lick times of each trial in samples
- `lickPeriodInd` - no longer in use
- `lickPeriodLfpInd` - no longer in use
- `lickPeriodT`
- `lickT`
- `mazeSess` - maze session for each trial 
- `mazeType` - task id for each trial. Active licking is 22. 
- `movieLocation` - no longer in use. Was used for cue translocation experiments
- `movieOffPulseLfpInd` - no longer in use. Was used for cue translocation experiments
- `movieOffPulseT`
- `movieOnLfpInd` - time stamp in samples of transitions between visual displays (could be the onset of the start - cue, cue-free zone, or blackout)
- `movieOnPulseLfpInd` - no longer in use
- `movieOnPulseT`
- `movieOnT`
- `pumpLfpInd` - time stamp of water delivery for each trial(in samples)
- `pumpT`
- `startLfpInd` - start time of each trial in samples - from the $TR directive
- `startT`
- `stimDiode` - which diodes were activated for each light pulse(not relevant for 2p) 
- `stimDiodeCurr` - current applied to each diode at each light pulse(not relevant for 2p)
- `stimOnLfpInd` - onset of each pulse train in samples(not relevant for 2p)
- `stimOnT`
- `stimPulseLfpInd` - time of each light pulse in a train in samples(not relevant for 2p)
- `stimPulseLoc` - position of light pulse along track-only for pulseMethod = 3
- `stimPulseMethod` - 2:at the run onset, 3: specified position along the track, 4: reward delivery
- `stimPulseT`
- `stimPulseWidth` - total duration of each pulse train in seconds
- `stimPulseWidthLfp` - duration of each pulse in a pulse train in samples
- `trackLen` - the length of the track for each trial in mm. 



## `Track`
- `F` Raw fluorescence of a ROI (suite2p output)
- `Fneu` Raw fluorescence from the neuropil of an ROI (suite2p output)
- `accel_MMsecSq` behavior: acceleration (mm/sec^2), calculated from xMM
- `accel_MMsecSqAll` behavior: acceleration (mm/sec^2), calculated from xMMAll 
- `behavType` Not used, set to 1
- `corrChoice` Not used, set to 1
- `dFF` deltaF/F, change in fluorescence
- `dFFSM Gaussian` filtered (see param.stdsm) and thresholded deltaF/F (should be used for field detection)
- `indNoise` entries where deltaF/F is smaller than a threshold are set to 1
- `lapID` which lap each entry belongs to
- `mazeSess` recording session, typically = 1 
- `mazeType` ignore for now
- `speed_MMsec behavior`: speed (mm/sec), calculated from xMM
- `speed_MMsecAll` behavior: speed (mm/sec), calculated from xMMAll
- `spikesSM` deconvoluted spikes, after thresholding
- `spks` deconvoluted spikes, no thresholding
- `startLfpInd` the start index of the trial to which the current entry belongs
- `xMM behavior`: distance within a trial, data points during the black-out period are set to 0 (need to double check)
- `xMMAll behavio`r: distance within a trial, including the distance run during the black-out period.




## `param`
- `prctile` Not used
- `stdsm` [0.3*lfpFreq/6], Gaussian filter for dFF, used in the process of computing dFFSM
- `threStd` [3] threshold for dFFSM

## other fields
- `lfpFreq [500.]`
- `sampleFreq [30.]`
- `Processing [1.]`